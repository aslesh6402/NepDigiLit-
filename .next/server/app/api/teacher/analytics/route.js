"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/teacher/analytics/route";
exports.ids = ["app/api/teacher/analytics/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fteacher%2Fanalytics%2Froute&page=%2Fapi%2Fteacher%2Fanalytics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fteacher%2Fanalytics%2Froute.ts&appDir=C%3A%5CUsers%5Cpc%5CDownloads%5Cproject%5Cproject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cpc%5CDownloads%5Cproject%5Cproject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fteacher%2Fanalytics%2Froute&page=%2Fapi%2Fteacher%2Fanalytics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fteacher%2Fanalytics%2Froute.ts&appDir=C%3A%5CUsers%5Cpc%5CDownloads%5Cproject%5Cproject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cpc%5CDownloads%5Cproject%5Cproject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_pc_Downloads_project_project_src_app_api_teacher_analytics_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/teacher/analytics/route.ts */ \"(rsc)/./src/app/api/teacher/analytics/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/teacher/analytics/route\",\n        pathname: \"/api/teacher/analytics\",\n        filename: \"route\",\n        bundlePath: \"app/api/teacher/analytics/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\pc\\\\Downloads\\\\project\\\\project\\\\src\\\\app\\\\api\\\\teacher\\\\analytics\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_pc_Downloads_project_project_src_app_api_teacher_analytics_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/teacher/analytics/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ0ZWFjaGVyJTJGYW5hbHl0aWNzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZ0ZWFjaGVyJTJGYW5hbHl0aWNzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGdGVhY2hlciUyRmFuYWx5dGljcyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNwYyU1Q0Rvd25sb2FkcyU1Q3Byb2plY3QlNUNwcm9qZWN0JTVDc3JjJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDVXNlcnMlNUNwYyU1Q0Rvd25sb2FkcyU1Q3Byb2plY3QlNUNwcm9qZWN0JmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUN1QztBQUNwSDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL2RpZ2l0YWwtbGl0ZXJhY3ktcG9ydGFsLz8xYzRhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFVzZXJzXFxcXHBjXFxcXERvd25sb2Fkc1xcXFxwcm9qZWN0XFxcXHByb2plY3RcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcdGVhY2hlclxcXFxhbmFseXRpY3NcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3RlYWNoZXIvYW5hbHl0aWNzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdGVhY2hlci9hbmFseXRpY3NcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3RlYWNoZXIvYW5hbHl0aWNzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxccGNcXFxcRG93bmxvYWRzXFxcXHByb2plY3RcXFxccHJvamVjdFxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFx0ZWFjaGVyXFxcXGFuYWx5dGljc1xcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvdGVhY2hlci9hbmFseXRpY3Mvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fteacher%2Fanalytics%2Froute&page=%2Fapi%2Fteacher%2Fanalytics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fteacher%2Fanalytics%2Froute.ts&appDir=C%3A%5CUsers%5Cpc%5CDownloads%5Cproject%5Cproject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cpc%5CDownloads%5Cproject%5Cproject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/teacher/analytics/route.ts":
/*!************************************************!*\
  !*** ./src/app/api/teacher/analytics/route.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./src/lib/auth.ts\");\n\n\n\n// GET /api/teacher/analytics - Get comprehensive teacher dashboard analytics\nasync function GET(request) {\n    try {\n        // Extract teacher from authenticated session\n        const teacher = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_2__.requireTeacher)(request);\n        const teacherId = teacher.id;\n        const { searchParams } = new URL(request.url);\n        const moduleId = searchParams.get(\"moduleId\");\n        const timeRange = searchParams.get(\"timeRange\") || \"30\"; // days\n        const dateFrom = new Date();\n        dateFrom.setDate(dateFrom.getDate() - parseInt(timeRange));\n        // Build base filters\n        const todoFilter = {\n            teacherId\n        };\n        const quizFilter = {\n            teacherId\n        };\n        const examFilter = {\n            teacherId\n        };\n        if (moduleId) {\n            todoFilter.moduleId = moduleId;\n            quizFilter.moduleId = moduleId;\n            examFilter.moduleId = moduleId;\n        }\n        // Get basic counts for todos\n        const todoCount = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.todo.count({\n            where: todoFilter\n        });\n        const todoProgressCount = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.todoProgress.count({\n            where: {\n                todo: {\n                    teacherId\n                },\n                completed: true\n            }\n        });\n        const totalTodoProgress = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.todoProgress.count({\n            where: {\n                todo: {\n                    teacherId\n                }\n            }\n        });\n        // Get quiz data\n        const quizCount = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.quiz.count({\n            where: quizFilter\n        });\n        const quizAttempts = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.quizAttempt.findMany({\n            where: {\n                quiz: {\n                    teacherId\n                },\n                createdAt: {\n                    gte: dateFrom\n                }\n            },\n            include: {\n                quiz: true,\n                user: {\n                    select: {\n                        id: true,\n                        name: true,\n                        email: true\n                    }\n                }\n            }\n        });\n        // Get exam data\n        const examCount = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.exam.count({\n            where: examFilter\n        });\n        const examAttempts = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.examAttempt.findMany({\n            where: {\n                exam: {\n                    teacherId\n                },\n                createdAt: {\n                    gte: dateFrom\n                }\n            },\n            include: {\n                exam: true,\n                user: {\n                    select: {\n                        id: true,\n                        name: true,\n                        email: true\n                    }\n                },\n                cheatingIncidents: true\n            }\n        });\n        // Get cheating incidents\n        const cheatingIncidents = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.cheatingIncident.findMany({\n            where: {\n                timestamp: {\n                    gte: dateFrom\n                },\n                examAttempt: {\n                    exam: {\n                        teacherId\n                    }\n                }\n            },\n            include: {\n                user: {\n                    select: {\n                        id: true,\n                        name: true,\n                        email: true\n                    }\n                },\n                examAttempt: {\n                    include: {\n                        exam: {\n                            select: {\n                                id: true,\n                                title: true\n                            }\n                        }\n                    }\n                }\n            },\n            orderBy: {\n                timestamp: \"desc\"\n            }\n        });\n        // Calculate statistics\n        const completedQuizAttempts = quizAttempts.filter((a)=>a.status === \"COMPLETED\");\n        const completedExamAttempts = examAttempts.filter((a)=>a.status === \"COMPLETED\");\n        const todoStats = {\n            total: todoCount,\n            totalAssignments: totalTodoProgress,\n            completed: todoProgressCount,\n            pending: totalTodoProgress - todoProgressCount,\n            overdue: 0\n        };\n        const quizStats = {\n            total: quizCount,\n            totalAttempts: quizAttempts.length,\n            completedAttempts: completedQuizAttempts.length,\n            averageScore: completedQuizAttempts.length > 0 ? Math.round(completedQuizAttempts.filter((a)=>a.score !== null).reduce((sum, a)=>sum + (a.score || 0), 0) / completedQuizAttempts.filter((a)=>a.score !== null).length) : 0,\n            passRate: (()=>{\n                const scoredAttempts = completedQuizAttempts.filter((a)=>a.score !== null);\n                if (scoredAttempts.length === 0) return 0;\n                const passedAttempts = scoredAttempts.filter((attempt)=>{\n                    return attempt.quiz && (attempt.score || 0) >= attempt.quiz.passingScore;\n                });\n                return Math.round(passedAttempts.length / scoredAttempts.length * 100);\n            })()\n        };\n        const examStats = {\n            total: examCount,\n            totalAttempts: examAttempts.length,\n            completedAttempts: completedExamAttempts.length,\n            flaggedAttempts: examAttempts.filter((a)=>a.status === \"FAILED\").length,\n            averageScore: completedExamAttempts.length > 0 ? Math.round(completedExamAttempts.filter((a)=>a.score !== null).reduce((sum, a)=>sum + (a.score || 0), 0) / completedExamAttempts.filter((a)=>a.score !== null).length) : 0,\n            passRate: (()=>{\n                const scoredAttempts = completedExamAttempts.filter((a)=>a.score !== null);\n                if (scoredAttempts.length === 0) return 0;\n                const passedAttempts = scoredAttempts.filter((attempt)=>{\n                    return attempt.exam && (attempt.score || 0) >= attempt.exam.passingMarks;\n                });\n                return Math.round(passedAttempts.length / scoredAttempts.length * 100);\n            })(),\n            cheatingIncidents: cheatingIncidents.length,\n            highRiskAttempts: examAttempts.filter((a)=>a.riskScore > 70).length\n        };\n        // Get recent activity - simplified\n        const recentTodos = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.todo.findMany({\n            where: todoFilter,\n            orderBy: {\n                createdAt: \"desc\"\n            },\n            take: 3\n        });\n        const recentQuizzes = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.quiz.findMany({\n            where: quizFilter,\n            orderBy: {\n                createdAt: \"desc\"\n            },\n            take: 3\n        });\n        const recentExams = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.exam.findMany({\n            where: examFilter,\n            orderBy: {\n                createdAt: \"desc\"\n            },\n            take: 3\n        });\n        const recentActivity = [\n            ...recentTodos.map((todo)=>({\n                    type: \"todo\",\n                    id: todo.id,\n                    title: todo.title,\n                    createdAt: todo.createdAt,\n                    stats: \"Todo created\"\n                })),\n            ...recentQuizzes.map((quiz)=>({\n                    type: \"quiz\",\n                    id: quiz.id,\n                    title: quiz.title,\n                    createdAt: quiz.createdAt,\n                    stats: \"Quiz created\"\n                })),\n            ...recentExams.map((exam)=>({\n                    type: \"exam\",\n                    id: exam.id,\n                    title: exam.title,\n                    createdAt: exam.createdAt,\n                    stats: \"Exam created\"\n                }))\n        ].sort((a, b)=>new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()).slice(0, 10);\n        // Get student performance overview - simplified\n        const studentMap = new Map();\n        // Collect student data from quiz attempts\n        completedQuizAttempts.forEach((attempt)=>{\n            if (attempt.score !== null) {\n                if (!studentMap.has(attempt.userId)) {\n                    studentMap.set(attempt.userId, {\n                        id: attempt.userId,\n                        name: attempt.user.name,\n                        email: attempt.user.email,\n                        todosCompleted: 0,\n                        todosTotal: 0,\n                        quizAttempts: 0,\n                        quizAvgScore: 0,\n                        examAttempts: 0,\n                        examAvgScore: 0,\n                        cheatingIncidents: 0\n                    });\n                }\n                const student = studentMap.get(attempt.userId);\n                student.quizAttempts++;\n                student.quizAvgScore = (student.quizAvgScore * (student.quizAttempts - 1) + attempt.score) / student.quizAttempts;\n            }\n        });\n        // Collect student data from exam attempts\n        completedExamAttempts.forEach((attempt)=>{\n            if (attempt.score !== null) {\n                if (!studentMap.has(attempt.userId)) {\n                    studentMap.set(attempt.userId, {\n                        id: attempt.userId,\n                        name: attempt.user.name,\n                        email: attempt.user.email,\n                        todosCompleted: 0,\n                        todosTotal: 0,\n                        quizAttempts: 0,\n                        quizAvgScore: 0,\n                        examAttempts: 0,\n                        examAvgScore: 0,\n                        cheatingIncidents: 0\n                    });\n                }\n                const student = studentMap.get(attempt.userId);\n                student.examAttempts++;\n                student.examAvgScore = (student.examAvgScore * (student.examAttempts - 1) + attempt.score) / student.examAttempts;\n                student.cheatingIncidents += attempt.cheatingIncidents?.length || 0;\n            }\n        });\n        const studentPerformance = Array.from(studentMap.values()).map((student)=>({\n                ...student,\n                quizAvgScore: Math.round(student.quizAvgScore),\n                examAvgScore: Math.round(student.examAvgScore),\n                todoCompletionRate: 0\n            })).sort((a, b)=>b.examAvgScore - a.examAvgScore);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            analytics: {\n                todos: todoStats,\n                quizzes: quizStats,\n                exams: examStats,\n                cheating: {\n                    totalIncidents: cheatingIncidents.length,\n                    recentIncidents: cheatingIncidents.slice(0, 10),\n                    incidentsByType: cheatingIncidents.reduce((acc, incident)=>{\n                        acc[incident.incidentType] = (acc[incident.incidentType] || 0) + 1;\n                        return acc;\n                    }, {}),\n                    incidentsBySeverity: cheatingIncidents.reduce((acc, incident)=>{\n                        acc[incident.severity] = (acc[incident.severity] || 0) + 1;\n                        return acc;\n                    }, {})\n                }\n            },\n            recentActivity,\n            studentPerformance: studentPerformance.slice(0, 20),\n            timeRange: parseInt(timeRange)\n        });\n    } catch (error) {\n        console.error(\"Error fetching teacher analytics:\", error);\n        if (error instanceof Error && (error.message === \"Authentication required\" || error.message === \"Teacher access required\")) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: error.message\n            }, {\n                status: 401\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to fetch analytics\",\n            details: error instanceof Error ? error.message : \"Unknown error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS90ZWFjaGVyL2FuYWx5dGljcy9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQXdEO0FBQ2xCO0FBQ007QUFFNUMsNkVBQTZFO0FBQ3RFLGVBQWVHLElBQUlDLE9BQW9CO0lBQzVDLElBQUk7UUFDRiw2Q0FBNkM7UUFDN0MsTUFBTUMsVUFBVSxNQUFNSCx5REFBY0EsQ0FBQ0U7UUFDckMsTUFBTUUsWUFBWUQsUUFBUUUsRUFBRTtRQUU1QixNQUFNLEVBQUVDLFlBQVksRUFBRSxHQUFHLElBQUlDLElBQUlMLFFBQVFNLEdBQUc7UUFDNUMsTUFBTUMsV0FBV0gsYUFBYUksR0FBRyxDQUFDO1FBQ2xDLE1BQU1DLFlBQVlMLGFBQWFJLEdBQUcsQ0FBQyxnQkFBZ0IsTUFBTSxPQUFPO1FBRWhFLE1BQU1FLFdBQVcsSUFBSUM7UUFDckJELFNBQVNFLE9BQU8sQ0FBQ0YsU0FBU0csT0FBTyxLQUFLQyxTQUFTTDtRQUUvQyxxQkFBcUI7UUFDckIsTUFBTU0sYUFBa0I7WUFBRWI7UUFBVTtRQUNwQyxNQUFNYyxhQUFrQjtZQUFFZDtRQUFVO1FBQ3BDLE1BQU1lLGFBQWtCO1lBQUVmO1FBQVU7UUFFcEMsSUFBSUssVUFBVTtZQUNaUSxXQUFXUixRQUFRLEdBQUdBO1lBQ3RCUyxXQUFXVCxRQUFRLEdBQUdBO1lBQ3RCVSxXQUFXVixRQUFRLEdBQUdBO1FBQ3hCO1FBRUEsNkJBQTZCO1FBQzdCLE1BQU1XLFlBQVksTUFBTXJCLCtDQUFNQSxDQUFDc0IsSUFBSSxDQUFDQyxLQUFLLENBQUM7WUFDeENDLE9BQU9OO1FBQ1Q7UUFFQSxNQUFNTyxvQkFBb0IsTUFBTXpCLCtDQUFNQSxDQUFDMEIsWUFBWSxDQUFDSCxLQUFLLENBQUM7WUFDeERDLE9BQU87Z0JBQ0xGLE1BQU07b0JBQUVqQjtnQkFBVTtnQkFDbEJzQixXQUFXO1lBQ2I7UUFDRjtRQUVBLE1BQU1DLG9CQUFvQixNQUFNNUIsK0NBQU1BLENBQUMwQixZQUFZLENBQUNILEtBQUss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QUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZGlnaXRhbC1saXRlcmFjeS1wb3J0YWwvLi9zcmMvYXBwL2FwaS90ZWFjaGVyL2FuYWx5dGljcy9yb3V0ZS50cz8yMWMxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IHByaXNtYSB9IGZyb20gXCJAL2xpYi9wcmlzbWFcIjtcbmltcG9ydCB7IHJlcXVpcmVUZWFjaGVyIH0gZnJvbSBcIkAvbGliL2F1dGhcIjtcblxuLy8gR0VUIC9hcGkvdGVhY2hlci9hbmFseXRpY3MgLSBHZXQgY29tcHJlaGVuc2l2ZSB0ZWFjaGVyIGRhc2hib2FyZCBhbmFseXRpY3NcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICAvLyBFeHRyYWN0IHRlYWNoZXIgZnJvbSBhdXRoZW50aWNhdGVkIHNlc3Npb25cbiAgICBjb25zdCB0ZWFjaGVyID0gYXdhaXQgcmVxdWlyZVRlYWNoZXIocmVxdWVzdCk7XG4gICAgY29uc3QgdGVhY2hlcklkID0gdGVhY2hlci5pZDtcblxuICAgIGNvbnN0IHsgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcbiAgICBjb25zdCBtb2R1bGVJZCA9IHNlYXJjaFBhcmFtcy5nZXQoXCJtb2R1bGVJZFwiKTtcbiAgICBjb25zdCB0aW1lUmFuZ2UgPSBzZWFyY2hQYXJhbXMuZ2V0KFwidGltZVJhbmdlXCIpIHx8IFwiMzBcIjsgLy8gZGF5c1xuXG4gICAgY29uc3QgZGF0ZUZyb20gPSBuZXcgRGF0ZSgpO1xuICAgIGRhdGVGcm9tLnNldERhdGUoZGF0ZUZyb20uZ2V0RGF0ZSgpIC0gcGFyc2VJbnQodGltZVJhbmdlKSk7XG5cbiAgICAvLyBCdWlsZCBiYXNlIGZpbHRlcnNcbiAgICBjb25zdCB0b2RvRmlsdGVyOiBhbnkgPSB7IHRlYWNoZXJJZCB9O1xuICAgIGNvbnN0IHF1aXpGaWx0ZXI6IGFueSA9IHsgdGVhY2hlcklkIH07XG4gICAgY29uc3QgZXhhbUZpbHRlcjogYW55ID0geyB0ZWFjaGVySWQgfTtcblxuICAgIGlmIChtb2R1bGVJZCkge1xuICAgICAgdG9kb0ZpbHRlci5tb2R1bGVJZCA9IG1vZHVsZUlkO1xuICAgICAgcXVpekZpbHRlci5tb2R1bGVJZCA9IG1vZHVsZUlkO1xuICAgICAgZXhhbUZpbHRlci5tb2R1bGVJZCA9IG1vZHVsZUlkO1xuICAgIH1cblxuICAgIC8vIEdldCBiYXNpYyBjb3VudHMgZm9yIHRvZG9zXG4gICAgY29uc3QgdG9kb0NvdW50ID0gYXdhaXQgcHJpc21hLnRvZG8uY291bnQoe1xuICAgICAgd2hlcmU6IHRvZG9GaWx0ZXIsXG4gICAgfSk7XG5cbiAgICBjb25zdCB0b2RvUHJvZ3Jlc3NDb3VudCA9IGF3YWl0IHByaXNtYS50b2RvUHJvZ3Jlc3MuY291bnQoe1xuICAgICAgd2hlcmU6IHtcbiAgICAgICAgdG9kbzogeyB0ZWFjaGVySWQgfSxcbiAgICAgICAgY29tcGxldGVkOiB0cnVlLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHRvdGFsVG9kb1Byb2dyZXNzID0gYXdhaXQgcHJpc21hLnRvZG9Qcm9ncmVzcy5jb3VudCh7XG4gICAgICB3aGVyZToge1xuICAgICAgICB0b2RvOiB7IHRlYWNoZXJJZCB9LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIEdldCBxdWl6IGRhdGFcbiAgICBjb25zdCBxdWl6Q291bnQgPSBhd2FpdCBwcmlzbWEucXVpei5jb3VudCh7XG4gICAgICB3aGVyZTogcXVpekZpbHRlcixcbiAgICB9KTtcblxuICAgIGNvbnN0IHF1aXpBdHRlbXB0cyA9IGF3YWl0IHByaXNtYS5xdWl6QXR0ZW1wdC5maW5kTWFueSh7XG4gICAgICB3aGVyZToge1xuICAgICAgICBxdWl6OiB7IHRlYWNoZXJJZCB9LFxuICAgICAgICBjcmVhdGVkQXQ6IHsgZ3RlOiBkYXRlRnJvbSB9LFxuICAgICAgfSxcbiAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgcXVpejogdHJ1ZSxcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgZW1haWw6IHRydWUgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBHZXQgZXhhbSBkYXRhXG4gICAgY29uc3QgZXhhbUNvdW50ID0gYXdhaXQgcHJpc21hLmV4YW0uY291bnQoe1xuICAgICAgd2hlcmU6IGV4YW1GaWx0ZXIsXG4gICAgfSk7XG5cbiAgICBjb25zdCBleGFtQXR0ZW1wdHMgPSBhd2FpdCBwcmlzbWEuZXhhbUF0dGVtcHQuZmluZE1hbnkoe1xuICAgICAgd2hlcmU6IHtcbiAgICAgICAgZXhhbTogeyB0ZWFjaGVySWQgfSxcbiAgICAgICAgY3JlYXRlZEF0OiB7IGd0ZTogZGF0ZUZyb20gfSxcbiAgICAgIH0sXG4gICAgICBpbmNsdWRlOiB7XG4gICAgICAgIGV4YW06IHRydWUsXG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBzZWxlY3Q6IHsgaWQ6IHRydWUsIG5hbWU6IHRydWUsIGVtYWlsOiB0cnVlIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGNoZWF0aW5nSW5jaWRlbnRzOiB0cnVlLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIEdldCBjaGVhdGluZyBpbmNpZGVudHNcbiAgICBjb25zdCBjaGVhdGluZ0luY2lkZW50cyA9IGF3YWl0IHByaXNtYS5jaGVhdGluZ0luY2lkZW50LmZpbmRNYW55KHtcbiAgICAgIHdoZXJlOiB7XG4gICAgICAgIHRpbWVzdGFtcDogeyBndGU6IGRhdGVGcm9tIH0sXG4gICAgICAgIGV4YW1BdHRlbXB0OiB7XG4gICAgICAgICAgZXhhbTogeyB0ZWFjaGVySWQgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBpbmNsdWRlOiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBzZWxlY3Q6IHsgaWQ6IHRydWUsIG5hbWU6IHRydWUsIGVtYWlsOiB0cnVlIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGV4YW1BdHRlbXB0OiB7XG4gICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgZXhhbToge1xuICAgICAgICAgICAgICBzZWxlY3Q6IHsgaWQ6IHRydWUsIHRpdGxlOiB0cnVlIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgb3JkZXJCeTogeyB0aW1lc3RhbXA6IFwiZGVzY1wiIH0sXG4gICAgfSk7XG5cbiAgICAvLyBDYWxjdWxhdGUgc3RhdGlzdGljc1xuICAgIGNvbnN0IGNvbXBsZXRlZFF1aXpBdHRlbXB0cyA9IHF1aXpBdHRlbXB0cy5maWx0ZXIoXG4gICAgICAoYSkgPT4gYS5zdGF0dXMgPT09IFwiQ09NUExFVEVEXCJcbiAgICApO1xuICAgIGNvbnN0IGNvbXBsZXRlZEV4YW1BdHRlbXB0cyA9IGV4YW1BdHRlbXB0cy5maWx0ZXIoXG4gICAgICAoYSkgPT4gYS5zdGF0dXMgPT09IFwiQ09NUExFVEVEXCJcbiAgICApO1xuXG4gICAgY29uc3QgdG9kb1N0YXRzID0ge1xuICAgICAgdG90YWw6IHRvZG9Db3VudCxcbiAgICAgIHRvdGFsQXNzaWdubWVudHM6IHRvdGFsVG9kb1Byb2dyZXNzLFxuICAgICAgY29tcGxldGVkOiB0b2RvUHJvZ3Jlc3NDb3VudCxcbiAgICAgIHBlbmRpbmc6IHRvdGFsVG9kb1Byb2dyZXNzIC0gdG9kb1Byb2dyZXNzQ291bnQsXG4gICAgICBvdmVyZHVlOiAwLCAvLyBXZSdsbCBzaW1wbGlmeSB0aGlzIGZvciBub3dcbiAgICB9O1xuXG4gICAgY29uc3QgcXVpelN0YXRzID0ge1xuICAgICAgdG90YWw6IHF1aXpDb3VudCxcbiAgICAgIHRvdGFsQXR0ZW1wdHM6IHF1aXpBdHRlbXB0cy5sZW5ndGgsXG4gICAgICBjb21wbGV0ZWRBdHRlbXB0czogY29tcGxldGVkUXVpekF0dGVtcHRzLmxlbmd0aCxcbiAgICAgIGF2ZXJhZ2VTY29yZTpcbiAgICAgICAgY29tcGxldGVkUXVpekF0dGVtcHRzLmxlbmd0aCA+IDBcbiAgICAgICAgICA/IE1hdGgucm91bmQoXG4gICAgICAgICAgICAgIGNvbXBsZXRlZFF1aXpBdHRlbXB0c1xuICAgICAgICAgICAgICAgIC5maWx0ZXIoKGEpID0+IGEuc2NvcmUgIT09IG51bGwpXG4gICAgICAgICAgICAgICAgLnJlZHVjZSgoc3VtLCBhKSA9PiBzdW0gKyAoYS5zY29yZSB8fCAwKSwgMCkgL1xuICAgICAgICAgICAgICAgIGNvbXBsZXRlZFF1aXpBdHRlbXB0cy5maWx0ZXIoKGEpID0+IGEuc2NvcmUgIT09IG51bGwpLmxlbmd0aFxuICAgICAgICAgICAgKVxuICAgICAgICAgIDogMCxcbiAgICAgIHBhc3NSYXRlOiAoKCkgPT4ge1xuICAgICAgICBjb25zdCBzY29yZWRBdHRlbXB0cyA9IGNvbXBsZXRlZFF1aXpBdHRlbXB0cy5maWx0ZXIoXG4gICAgICAgICAgKGEpID0+IGEuc2NvcmUgIT09IG51bGxcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKHNjb3JlZEF0dGVtcHRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDA7XG5cbiAgICAgICAgY29uc3QgcGFzc2VkQXR0ZW1wdHMgPSBzY29yZWRBdHRlbXB0cy5maWx0ZXIoKGF0dGVtcHQpID0+IHtcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgYXR0ZW1wdC5xdWl6ICYmIChhdHRlbXB0LnNjb3JlIHx8IDApID49IGF0dGVtcHQucXVpei5wYXNzaW5nU2NvcmVcbiAgICAgICAgICApO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChcbiAgICAgICAgICAocGFzc2VkQXR0ZW1wdHMubGVuZ3RoIC8gc2NvcmVkQXR0ZW1wdHMubGVuZ3RoKSAqIDEwMFxuICAgICAgICApO1xuICAgICAgfSkoKSxcbiAgICB9O1xuXG4gICAgY29uc3QgZXhhbVN0YXRzID0ge1xuICAgICAgdG90YWw6IGV4YW1Db3VudCxcbiAgICAgIHRvdGFsQXR0ZW1wdHM6IGV4YW1BdHRlbXB0cy5sZW5ndGgsXG4gICAgICBjb21wbGV0ZWRBdHRlbXB0czogY29tcGxldGVkRXhhbUF0dGVtcHRzLmxlbmd0aCxcbiAgICAgIGZsYWdnZWRBdHRlbXB0czogZXhhbUF0dGVtcHRzLmZpbHRlcigoYSkgPT4gYS5zdGF0dXMgPT09IFwiRkFJTEVEXCIpLmxlbmd0aCxcbiAgICAgIGF2ZXJhZ2VTY29yZTpcbiAgICAgICAgY29tcGxldGVkRXhhbUF0dGVtcHRzLmxlbmd0aCA+IDBcbiAgICAgICAgICA/IE1hdGgucm91bmQoXG4gICAgICAgICAgICAgIGNvbXBsZXRlZEV4YW1BdHRlbXB0c1xuICAgICAgICAgICAgICAgIC5maWx0ZXIoKGEpID0+IGEuc2NvcmUgIT09IG51bGwpXG4gICAgICAgICAgICAgICAgLnJlZHVjZSgoc3VtLCBhKSA9PiBzdW0gKyAoYS5zY29yZSB8fCAwKSwgMCkgL1xuICAgICAgICAgICAgICAgIGNvbXBsZXRlZEV4YW1BdHRlbXB0cy5maWx0ZXIoKGEpID0+IGEuc2NvcmUgIT09IG51bGwpLmxlbmd0aFxuICAgICAgICAgICAgKVxuICAgICAgICAgIDogMCxcbiAgICAgIHBhc3NSYXRlOiAoKCkgPT4ge1xuICAgICAgICBjb25zdCBzY29yZWRBdHRlbXB0cyA9IGNvbXBsZXRlZEV4YW1BdHRlbXB0cy5maWx0ZXIoXG4gICAgICAgICAgKGEpID0+IGEuc2NvcmUgIT09IG51bGxcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKHNjb3JlZEF0dGVtcHRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDA7XG5cbiAgICAgICAgY29uc3QgcGFzc2VkQXR0ZW1wdHMgPSBzY29yZWRBdHRlbXB0cy5maWx0ZXIoKGF0dGVtcHQpID0+IHtcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgYXR0ZW1wdC5leGFtICYmIChhdHRlbXB0LnNjb3JlIHx8IDApID49IGF0dGVtcHQuZXhhbS5wYXNzaW5nTWFya3NcbiAgICAgICAgICApO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChcbiAgICAgICAgICAocGFzc2VkQXR0ZW1wdHMubGVuZ3RoIC8gc2NvcmVkQXR0ZW1wdHMubGVuZ3RoKSAqIDEwMFxuICAgICAgICApO1xuICAgICAgfSkoKSxcbiAgICAgIGNoZWF0aW5nSW5jaWRlbnRzOiBjaGVhdGluZ0luY2lkZW50cy5sZW5ndGgsXG4gICAgICBoaWdoUmlza0F0dGVtcHRzOiBleGFtQXR0ZW1wdHMuZmlsdGVyKChhKSA9PiBhLnJpc2tTY29yZSA+IDcwKS5sZW5ndGgsXG4gICAgfTtcblxuICAgIC8vIEdldCByZWNlbnQgYWN0aXZpdHkgLSBzaW1wbGlmaWVkXG4gICAgY29uc3QgcmVjZW50VG9kb3MgPSBhd2FpdCBwcmlzbWEudG9kby5maW5kTWFueSh7XG4gICAgICB3aGVyZTogdG9kb0ZpbHRlcixcbiAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiBcImRlc2NcIiB9LFxuICAgICAgdGFrZTogMyxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlY2VudFF1aXp6ZXMgPSBhd2FpdCBwcmlzbWEucXVpei5maW5kTWFueSh7XG4gICAgICB3aGVyZTogcXVpekZpbHRlcixcbiAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiBcImRlc2NcIiB9LFxuICAgICAgdGFrZTogMyxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlY2VudEV4YW1zID0gYXdhaXQgcHJpc21hLmV4YW0uZmluZE1hbnkoe1xuICAgICAgd2hlcmU6IGV4YW1GaWx0ZXIsXG4gICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogXCJkZXNjXCIgfSxcbiAgICAgIHRha2U6IDMsXG4gICAgfSk7XG5cbiAgICBjb25zdCByZWNlbnRBY3Rpdml0eSA9IFtcbiAgICAgIC4uLnJlY2VudFRvZG9zLm1hcCgodG9kbykgPT4gKHtcbiAgICAgICAgdHlwZTogXCJ0b2RvXCIgYXMgY29uc3QsXG4gICAgICAgIGlkOiB0b2RvLmlkLFxuICAgICAgICB0aXRsZTogdG9kby50aXRsZSxcbiAgICAgICAgY3JlYXRlZEF0OiB0b2RvLmNyZWF0ZWRBdCxcbiAgICAgICAgc3RhdHM6IFwiVG9kbyBjcmVhdGVkXCIsXG4gICAgICB9KSksXG4gICAgICAuLi5yZWNlbnRRdWl6emVzLm1hcCgocXVpeikgPT4gKHtcbiAgICAgICAgdHlwZTogXCJxdWl6XCIgYXMgY29uc3QsXG4gICAgICAgIGlkOiBxdWl6LmlkLFxuICAgICAgICB0aXRsZTogcXVpei50aXRsZSxcbiAgICAgICAgY3JlYXRlZEF0OiBxdWl6LmNyZWF0ZWRBdCxcbiAgICAgICAgc3RhdHM6IFwiUXVpeiBjcmVhdGVkXCIsXG4gICAgICB9KSksXG4gICAgICAuLi5yZWNlbnRFeGFtcy5tYXAoKGV4YW0pID0+ICh7XG4gICAgICAgIHR5cGU6IFwiZXhhbVwiIGFzIGNvbnN0LFxuICAgICAgICBpZDogZXhhbS5pZCxcbiAgICAgICAgdGl0bGU6IGV4YW0udGl0bGUsXG4gICAgICAgIGNyZWF0ZWRBdDogZXhhbS5jcmVhdGVkQXQsXG4gICAgICAgIHN0YXRzOiBcIkV4YW0gY3JlYXRlZFwiLFxuICAgICAgfSkpLFxuICAgIF1cbiAgICAgIC5zb3J0KFxuICAgICAgICAoYSwgYikgPT5cbiAgICAgICAgICBuZXcgRGF0ZShiLmNyZWF0ZWRBdCkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYS5jcmVhdGVkQXQpLmdldFRpbWUoKVxuICAgICAgKVxuICAgICAgLnNsaWNlKDAsIDEwKTtcblxuICAgIC8vIEdldCBzdHVkZW50IHBlcmZvcm1hbmNlIG92ZXJ2aWV3IC0gc2ltcGxpZmllZFxuICAgIGNvbnN0IHN0dWRlbnRNYXAgPSBuZXcgTWFwPHN0cmluZywgYW55PigpO1xuXG4gICAgLy8gQ29sbGVjdCBzdHVkZW50IGRhdGEgZnJvbSBxdWl6IGF0dGVtcHRzXG4gICAgY29tcGxldGVkUXVpekF0dGVtcHRzLmZvckVhY2goKGF0dGVtcHQpID0+IHtcbiAgICAgIGlmIChhdHRlbXB0LnNjb3JlICE9PSBudWxsKSB7XG4gICAgICAgIGlmICghc3R1ZGVudE1hcC5oYXMoYXR0ZW1wdC51c2VySWQpKSB7XG4gICAgICAgICAgc3R1ZGVudE1hcC5zZXQoYXR0ZW1wdC51c2VySWQsIHtcbiAgICAgICAgICAgIGlkOiBhdHRlbXB0LnVzZXJJZCxcbiAgICAgICAgICAgIG5hbWU6IGF0dGVtcHQudXNlci5uYW1lLFxuICAgICAgICAgICAgZW1haWw6IGF0dGVtcHQudXNlci5lbWFpbCxcbiAgICAgICAgICAgIHRvZG9zQ29tcGxldGVkOiAwLFxuICAgICAgICAgICAgdG9kb3NUb3RhbDogMCxcbiAgICAgICAgICAgIHF1aXpBdHRlbXB0czogMCxcbiAgICAgICAgICAgIHF1aXpBdmdTY29yZTogMCxcbiAgICAgICAgICAgIGV4YW1BdHRlbXB0czogMCxcbiAgICAgICAgICAgIGV4YW1BdmdTY29yZTogMCxcbiAgICAgICAgICAgIGNoZWF0aW5nSW5jaWRlbnRzOiAwLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHN0dWRlbnQgPSBzdHVkZW50TWFwLmdldChhdHRlbXB0LnVzZXJJZCk7XG4gICAgICAgIHN0dWRlbnQucXVpekF0dGVtcHRzKys7XG4gICAgICAgIHN0dWRlbnQucXVpekF2Z1Njb3JlID1cbiAgICAgICAgICAoc3R1ZGVudC5xdWl6QXZnU2NvcmUgKiAoc3R1ZGVudC5xdWl6QXR0ZW1wdHMgLSAxKSArIGF0dGVtcHQuc2NvcmUpIC9cbiAgICAgICAgICBzdHVkZW50LnF1aXpBdHRlbXB0cztcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIENvbGxlY3Qgc3R1ZGVudCBkYXRhIGZyb20gZXhhbSBhdHRlbXB0c1xuICAgIGNvbXBsZXRlZEV4YW1BdHRlbXB0cy5mb3JFYWNoKChhdHRlbXB0KSA9PiB7XG4gICAgICBpZiAoYXR0ZW1wdC5zY29yZSAhPT0gbnVsbCkge1xuICAgICAgICBpZiAoIXN0dWRlbnRNYXAuaGFzKGF0dGVtcHQudXNlcklkKSkge1xuICAgICAgICAgIHN0dWRlbnRNYXAuc2V0KGF0dGVtcHQudXNlcklkLCB7XG4gICAgICAgICAgICBpZDogYXR0ZW1wdC51c2VySWQsXG4gICAgICAgICAgICBuYW1lOiBhdHRlbXB0LnVzZXIubmFtZSxcbiAgICAgICAgICAgIGVtYWlsOiBhdHRlbXB0LnVzZXIuZW1haWwsXG4gICAgICAgICAgICB0b2Rvc0NvbXBsZXRlZDogMCxcbiAgICAgICAgICAgIHRvZG9zVG90YWw6IDAsXG4gICAgICAgICAgICBxdWl6QXR0ZW1wdHM6IDAsXG4gICAgICAgICAgICBxdWl6QXZnU2NvcmU6IDAsXG4gICAgICAgICAgICBleGFtQXR0ZW1wdHM6IDAsXG4gICAgICAgICAgICBleGFtQXZnU2NvcmU6IDAsXG4gICAgICAgICAgICBjaGVhdGluZ0luY2lkZW50czogMCxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzdHVkZW50ID0gc3R1ZGVudE1hcC5nZXQoYXR0ZW1wdC51c2VySWQpO1xuICAgICAgICBzdHVkZW50LmV4YW1BdHRlbXB0cysrO1xuICAgICAgICBzdHVkZW50LmV4YW1BdmdTY29yZSA9XG4gICAgICAgICAgKHN0dWRlbnQuZXhhbUF2Z1Njb3JlICogKHN0dWRlbnQuZXhhbUF0dGVtcHRzIC0gMSkgKyBhdHRlbXB0LnNjb3JlKSAvXG4gICAgICAgICAgc3R1ZGVudC5leGFtQXR0ZW1wdHM7XG4gICAgICAgIHN0dWRlbnQuY2hlYXRpbmdJbmNpZGVudHMgKz0gYXR0ZW1wdC5jaGVhdGluZ0luY2lkZW50cz8ubGVuZ3RoIHx8IDA7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCBzdHVkZW50UGVyZm9ybWFuY2UgPSBBcnJheS5mcm9tKHN0dWRlbnRNYXAudmFsdWVzKCkpXG4gICAgICAubWFwKChzdHVkZW50KSA9PiAoe1xuICAgICAgICAuLi5zdHVkZW50LFxuICAgICAgICBxdWl6QXZnU2NvcmU6IE1hdGgucm91bmQoc3R1ZGVudC5xdWl6QXZnU2NvcmUpLFxuICAgICAgICBleGFtQXZnU2NvcmU6IE1hdGgucm91bmQoc3R1ZGVudC5leGFtQXZnU2NvcmUpLFxuICAgICAgICB0b2RvQ29tcGxldGlvblJhdGU6IDAsIC8vIFNpbXBsaWZpZWQgZm9yIG5vd1xuICAgICAgfSkpXG4gICAgICAuc29ydCgoYSwgYikgPT4gYi5leGFtQXZnU2NvcmUgLSBhLmV4YW1BdmdTY29yZSk7XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgYW5hbHl0aWNzOiB7XG4gICAgICAgIHRvZG9zOiB0b2RvU3RhdHMsXG4gICAgICAgIHF1aXp6ZXM6IHF1aXpTdGF0cyxcbiAgICAgICAgZXhhbXM6IGV4YW1TdGF0cyxcbiAgICAgICAgY2hlYXRpbmc6IHtcbiAgICAgICAgICB0b3RhbEluY2lkZW50czogY2hlYXRpbmdJbmNpZGVudHMubGVuZ3RoLFxuICAgICAgICAgIHJlY2VudEluY2lkZW50czogY2hlYXRpbmdJbmNpZGVudHMuc2xpY2UoMCwgMTApLFxuICAgICAgICAgIGluY2lkZW50c0J5VHlwZTogY2hlYXRpbmdJbmNpZGVudHMucmVkdWNlKChhY2M6IGFueSwgaW5jaWRlbnQpID0+IHtcbiAgICAgICAgICAgIGFjY1tpbmNpZGVudC5pbmNpZGVudFR5cGVdID0gKGFjY1tpbmNpZGVudC5pbmNpZGVudFR5cGVdIHx8IDApICsgMTtcbiAgICAgICAgICAgIHJldHVybiBhY2M7XG4gICAgICAgICAgfSwge30pLFxuICAgICAgICAgIGluY2lkZW50c0J5U2V2ZXJpdHk6IGNoZWF0aW5nSW5jaWRlbnRzLnJlZHVjZShcbiAgICAgICAgICAgIChhY2M6IGFueSwgaW5jaWRlbnQpID0+IHtcbiAgICAgICAgICAgICAgYWNjW2luY2lkZW50LnNldmVyaXR5XSA9IChhY2NbaW5jaWRlbnQuc2V2ZXJpdHldIHx8IDApICsgMTtcbiAgICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7fVxuICAgICAgICAgICksXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgcmVjZW50QWN0aXZpdHksXG4gICAgICBzdHVkZW50UGVyZm9ybWFuY2U6IHN0dWRlbnRQZXJmb3JtYW5jZS5zbGljZSgwLCAyMCksXG4gICAgICB0aW1lUmFuZ2U6IHBhcnNlSW50KHRpbWVSYW5nZSksXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIHRlYWNoZXIgYW5hbHl0aWNzOlwiLCBlcnJvcik7XG5cbiAgICBpZiAoXG4gICAgICBlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmXG4gICAgICAoZXJyb3IubWVzc2FnZSA9PT0gXCJBdXRoZW50aWNhdGlvbiByZXF1aXJlZFwiIHx8XG4gICAgICAgIGVycm9yLm1lc3NhZ2UgPT09IFwiVGVhY2hlciBhY2Nlc3MgcmVxdWlyZWRcIilcbiAgICApIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA0MDEgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAge1xuICAgICAgICBlcnJvcjogXCJGYWlsZWQgdG8gZmV0Y2ggYW5hbHl0aWNzXCIsXG4gICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCIsXG4gICAgICB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInByaXNtYSIsInJlcXVpcmVUZWFjaGVyIiwiR0VUIiwicmVxdWVzdCIsInRlYWNoZXIiLCJ0ZWFjaGVySWQiLCJpZCIsInNlYXJjaFBhcmFtcyIsIlVSTCIsInVybCIsIm1vZHVsZUlkIiwiZ2V0IiwidGltZVJhbmdlIiwiZGF0ZUZyb20iLCJEYXRlIiwic2V0RGF0ZSIsImdldERhdGUiLCJwYXJzZUludCIsInRvZG9GaWx0ZXIiLCJxdWl6RmlsdGVyIiwiZXhhbUZpbHRlciIsInRvZG9Db3VudCIsInRvZG8iLCJjb3VudCIsIndoZXJlIiwidG9kb1Byb2dyZXNzQ291bnQiLCJ0b2RvUHJvZ3Jlc3MiLCJjb21wbGV0ZWQiLCJ0b3RhbFRvZG9Qcm9ncmVzcyIsInF1aXpDb3VudCIsInF1aXoiLCJxdWl6QXR0ZW1wdHMiLCJxdWl6QXR0ZW1wdCIsImZpbmRNYW55IiwiY3JlYXRlZEF0IiwiZ3RlIiwiaW5jbHVkZSIsInVzZXIiLCJzZWxlY3QiLCJuYW1lIiwiZW1haWwiLCJleGFtQ291bnQiLCJleGFtIiwiZXhhbUF0dGVtcHRzIiwiZXhhbUF0dGVtcHQiLCJjaGVhdGluZ0luY2lkZW50cyIsImNoZWF0aW5nSW5jaWRlbnQiLCJ0aW1lc3RhbXAiLCJ0aXRsZSIsIm9yZGVyQnkiLCJjb21wbGV0ZWRRdWl6QXR0ZW1wdHMiLCJmaWx0ZXIiLCJhIiwic3RhdHVzIiwiY29tcGxldGVkRXhhbUF0dGVtcHRzIiwidG9kb1N0YXRzIiwidG90YWwiLCJ0b3RhbEFzc2lnbm1lbnRzIiwicGVuZGluZyIsIm92ZXJkdWUiLCJxdWl6U3RhdHMiLCJ0b3RhbEF0dGVtcHRzIiwibGVuZ3RoIiwiY29tcGxldGVkQXR0ZW1wdHMiLCJhdmVyYWdlU2NvcmUiLCJNYXRoIiwicm91bmQiLCJzY29yZSIsInJlZHVjZSIsInN1bSIsInBhc3NSYXRlIiwic2NvcmVkQXR0ZW1wdHMiLCJwYXNzZWRBdHRlbXB0cyIsImF0dGVtcHQiLCJwYXNzaW5nU2NvcmUiLCJleGFtU3RhdHMiLCJmbGFnZ2VkQXR0ZW1wdHMiLCJwYXNzaW5nTWFya3MiLCJoaWdoUmlza0F0dGVtcHRzIiwicmlza1Njb3JlIiwicmVjZW50VG9kb3MiLCJ0YWtlIiwicmVjZW50UXVpenplcyIsInJlY2VudEV4YW1zIiwicmVjZW50QWN0aXZpdHkiLCJtYXAiLCJ0eXBlIiwic3RhdHMiLCJzb3J0IiwiYiIsImdldFRpbWUiLCJzbGljZSIsInN0dWRlbnRNYXAiLCJNYXAiLCJmb3JFYWNoIiwiaGFzIiwidXNlcklkIiwic2V0IiwidG9kb3NDb21wbGV0ZWQiLCJ0b2Rvc1RvdGFsIiwicXVpekF2Z1Njb3JlIiwiZXhhbUF2Z1Njb3JlIiwic3R1ZGVudCIsInN0dWRlbnRQZXJmb3JtYW5jZSIsIkFycmF5IiwiZnJvbSIsInZhbHVlcyIsInRvZG9Db21wbGV0aW9uUmF0ZSIsImpzb24iLCJhbmFseXRpY3MiLCJ0b2RvcyIsInF1aXp6ZXMiLCJleGFtcyIsImNoZWF0aW5nIiwidG90YWxJbmNpZGVudHMiLCJyZWNlbnRJbmNpZGVudHMiLCJpbmNpZGVudHNCeVR5cGUiLCJhY2MiLCJpbmNpZGVudCIsImluY2lkZW50VHlwZSIsImluY2lkZW50c0J5U2V2ZXJpdHkiLCJzZXZlcml0eSIsImVycm9yIiwiY29uc29sZSIsIkVycm9yIiwibWVzc2FnZSIsImRldGFpbHMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/teacher/analytics/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getUserFromRequest: () => (/* binding */ getUserFromRequest),\n/* harmony export */   requireStudent: () => (/* binding */ requireStudent),\n/* harmony export */   requireTeacher: () => (/* binding */ requireTeacher)\n/* harmony export */ });\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"(rsc)/./node_modules/jsonwebtoken/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n\n\nasync function getUserFromRequest(request) {\n    try {\n        // First, try to get token from Authorization header (for API calls)\n        let token = request.headers.get(\"authorization\");\n        if (token && token.startsWith(\"Bearer \")) {\n            token = token.substring(7);\n        } else {\n            // If no Authorization header, try to get from cookies (for SSR)\n            token = request.cookies.get(\"auth-token\")?.value || null;\n        }\n        if (!token) {\n            return null;\n        }\n        // Verify the JWT token\n        const decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(token, process.env.JWT_SECRET || \"your-secret-key\");\n        // Get user from database to ensure they still exist\n        const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.user.findUnique({\n            where: {\n                id: decoded.userId\n            },\n            select: {\n                id: true,\n                email: true,\n                name: true,\n                role: true,\n                grade: true,\n                school: true\n            }\n        });\n        return user;\n    } catch (error) {\n        console.error(\"Error extracting user from request:\", error);\n        return null;\n    }\n}\nasync function requireTeacher(request) {\n    const user = await getUserFromRequest(request);\n    if (!user) {\n        throw new Error(\"Authentication required\");\n    }\n    if (user.role !== \"TEACHER\") {\n        throw new Error(\"Teacher access required\");\n    }\n    return user;\n}\nasync function requireStudent(request) {\n    const user = await getUserFromRequest(request);\n    if (!user) {\n        throw new Error(\"Authentication required\");\n    }\n    if (user.role !== \"STUDENT\") {\n        throw new Error(\"Student access required\");\n    }\n    return user;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2F1dGgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQStCO0FBRU87QUFRL0IsZUFBZUUsbUJBQW1CQyxPQUFvQjtJQUMzRCxJQUFJO1FBQ0Ysb0VBQW9FO1FBQ3BFLElBQUlDLFFBQVFELFFBQVFFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDO1FBQ2hDLElBQUlGLFNBQVNBLE1BQU1HLFVBQVUsQ0FBQyxZQUFZO1lBQ3hDSCxRQUFRQSxNQUFNSSxTQUFTLENBQUM7UUFDMUIsT0FBTztZQUNMLGdFQUFnRTtZQUNoRUosUUFBUUQsUUFBUU0sT0FBTyxDQUFDSCxHQUFHLENBQUMsZUFBZUksU0FBUztRQUN0RDtRQUVBLElBQUksQ0FBQ04sT0FBTztZQUNWLE9BQU87UUFDVDtRQUVBLHVCQUF1QjtRQUN2QixNQUFNTyxVQUFVWCwwREFBVSxDQUN4QkksT0FDQVMsUUFBUUMsR0FBRyxDQUFDQyxVQUFVLElBQUk7UUFHNUIsb0RBQW9EO1FBQ3BELE1BQU1DLE9BQU8sTUFBTWYsK0NBQU1BLENBQUNlLElBQUksQ0FBQ0MsVUFBVSxDQUFDO1lBQ3hDQyxPQUFPO2dCQUFFQyxJQUFJUixRQUFRUyxNQUFNO1lBQUM7WUFDNUJDLFFBQVE7Z0JBQ05GLElBQUk7Z0JBQ0pHLE9BQU87Z0JBQ1BDLE1BQU07Z0JBQ05DLE1BQU07Z0JBQ05DLE9BQU87Z0JBQ1BDLFFBQVE7WUFDVjtRQUNGO1FBRUEsT0FBT1Y7SUFDVCxFQUFFLE9BQU9XLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLHVDQUF1Q0E7UUFDckQsT0FBTztJQUNUO0FBQ0Y7QUFFTyxlQUFlRSxlQUFlMUIsT0FBb0I7SUFDdkQsTUFBTWEsT0FBTyxNQUFNZCxtQkFBbUJDO0lBRXRDLElBQUksQ0FBQ2EsTUFBTTtRQUNULE1BQU0sSUFBSWMsTUFBTTtJQUNsQjtJQUVBLElBQUlkLEtBQUtRLElBQUksS0FBSyxXQUFXO1FBQzNCLE1BQU0sSUFBSU0sTUFBTTtJQUNsQjtJQUVBLE9BQU9kO0FBQ1Q7QUFFTyxlQUFlZSxlQUFlNUIsT0FBb0I7SUFDdkQsTUFBTWEsT0FBTyxNQUFNZCxtQkFBbUJDO0lBRXRDLElBQUksQ0FBQ2EsTUFBTTtRQUNULE1BQU0sSUFBSWMsTUFBTTtJQUNsQjtJQUVBLElBQUlkLEtBQUtRLElBQUksS0FBSyxXQUFXO1FBQzNCLE1BQU0sSUFBSU0sTUFBTTtJQUNsQjtJQUVBLE9BQU9kO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kaWdpdGFsLWxpdGVyYWN5LXBvcnRhbC8uL3NyYy9saWIvYXV0aC50cz82NjkyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBqd3QgZnJvbSBcImpzb253ZWJ0b2tlblwiO1xuaW1wb3J0IHsgTmV4dFJlcXVlc3QgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IHByaXNtYSB9IGZyb20gXCJAL2xpYi9wcmlzbWFcIjtcblxuaW50ZXJmYWNlIEpXVFBheWxvYWQge1xuICB1c2VySWQ6IHN0cmluZztcbiAgZW1haWw6IHN0cmluZztcbiAgcm9sZTogc3RyaW5nO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlckZyb21SZXF1ZXN0KHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgLy8gRmlyc3QsIHRyeSB0byBnZXQgdG9rZW4gZnJvbSBBdXRob3JpemF0aW9uIGhlYWRlciAoZm9yIEFQSSBjYWxscylcbiAgICBsZXQgdG9rZW4gPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KFwiYXV0aG9yaXphdGlvblwiKTtcbiAgICBpZiAodG9rZW4gJiYgdG9rZW4uc3RhcnRzV2l0aChcIkJlYXJlciBcIikpIHtcbiAgICAgIHRva2VuID0gdG9rZW4uc3Vic3RyaW5nKDcpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBJZiBubyBBdXRob3JpemF0aW9uIGhlYWRlciwgdHJ5IHRvIGdldCBmcm9tIGNvb2tpZXMgKGZvciBTU1IpXG4gICAgICB0b2tlbiA9IHJlcXVlc3QuY29va2llcy5nZXQoXCJhdXRoLXRva2VuXCIpPy52YWx1ZSB8fCBudWxsO1xuICAgIH1cblxuICAgIGlmICghdG9rZW4pIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vIFZlcmlmeSB0aGUgSldUIHRva2VuXG4gICAgY29uc3QgZGVjb2RlZCA9IGp3dC52ZXJpZnkoXG4gICAgICB0b2tlbixcbiAgICAgIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQgfHwgXCJ5b3VyLXNlY3JldC1rZXlcIlxuICAgICkgYXMgSldUUGF5bG9hZDtcblxuICAgIC8vIEdldCB1c2VyIGZyb20gZGF0YWJhc2UgdG8gZW5zdXJlIHRoZXkgc3RpbGwgZXhpc3RcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICB3aGVyZTogeyBpZDogZGVjb2RlZC51c2VySWQgfSxcbiAgICAgIHNlbGVjdDoge1xuICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgZW1haWw6IHRydWUsXG4gICAgICAgIG5hbWU6IHRydWUsXG4gICAgICAgIHJvbGU6IHRydWUsXG4gICAgICAgIGdyYWRlOiB0cnVlLFxuICAgICAgICBzY2hvb2w6IHRydWUsXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHVzZXI7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGV4dHJhY3RpbmcgdXNlciBmcm9tIHJlcXVlc3Q6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZVRlYWNoZXIocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3QgdXNlciA9IGF3YWl0IGdldFVzZXJGcm9tUmVxdWVzdChyZXF1ZXN0KTtcblxuICBpZiAoIXVzZXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdXRoZW50aWNhdGlvbiByZXF1aXJlZFwiKTtcbiAgfVxuXG4gIGlmICh1c2VyLnJvbGUgIT09IFwiVEVBQ0hFUlwiKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiVGVhY2hlciBhY2Nlc3MgcmVxdWlyZWRcIik7XG4gIH1cblxuICByZXR1cm4gdXNlcjtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcXVpcmVTdHVkZW50KHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBnZXRVc2VyRnJvbVJlcXVlc3QocmVxdWVzdCk7XG5cbiAgaWYgKCF1c2VyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQXV0aGVudGljYXRpb24gcmVxdWlyZWRcIik7XG4gIH1cblxuICBpZiAodXNlci5yb2xlICE9PSBcIlNUVURFTlRcIikge1xuICAgIHRocm93IG5ldyBFcnJvcihcIlN0dWRlbnQgYWNjZXNzIHJlcXVpcmVkXCIpO1xuICB9XG5cbiAgcmV0dXJuIHVzZXI7XG59XG4iXSwibmFtZXMiOlsiand0IiwicHJpc21hIiwiZ2V0VXNlckZyb21SZXF1ZXN0IiwicmVxdWVzdCIsInRva2VuIiwiaGVhZGVycyIsImdldCIsInN0YXJ0c1dpdGgiLCJzdWJzdHJpbmciLCJjb29raWVzIiwidmFsdWUiLCJkZWNvZGVkIiwidmVyaWZ5IiwicHJvY2VzcyIsImVudiIsIkpXVF9TRUNSRVQiLCJ1c2VyIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwiaWQiLCJ1c2VySWQiLCJzZWxlY3QiLCJlbWFpbCIsIm5hbWUiLCJyb2xlIiwiZ3JhZGUiLCJzY2hvb2wiLCJlcnJvciIsImNvbnNvbGUiLCJyZXF1aXJlVGVhY2hlciIsIkVycm9yIiwicmVxdWlyZVN0dWRlbnQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBNkM7QUFFN0MsTUFBTUMsa0JBQWtCQztBQUlqQixNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSSxJQUFJSCx3REFBWUEsR0FBRTtBQUVsRSxJQUFJSSxJQUF5QixFQUFjSCxnQkFBZ0JFLE1BQU0sR0FBR0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kaWdpdGFsLWxpdGVyYWN5LXBvcnRhbC8uL3NyYy9saWIvcHJpc21hLnRzPzAxZDciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5cbmNvbnN0IGdsb2JhbEZvclByaXNtYSA9IGdsb2JhbFRoaXMgYXMgdW5rbm93biBhcyB7XG4gIHByaXNtYTogUHJpc21hQ2xpZW50IHwgdW5kZWZpbmVkXG59XG5cbmV4cG9ydCBjb25zdCBwcmlzbWEgPSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID8/IG5ldyBQcmlzbWFDbGllbnQoKVxuXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA9IHByaXNtYSJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJnbG9iYWxGb3JQcmlzbWEiLCJnbG9iYWxUaGlzIiwicHJpc21hIiwicHJvY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/jsonwebtoken","vendor-chunks/lodash.includes","vendor-chunks/jws","vendor-chunks/lodash.once","vendor-chunks/jwa","vendor-chunks/lodash.isinteger","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/lodash.isplainobject","vendor-chunks/ms","vendor-chunks/lodash.isstring","vendor-chunks/lodash.isnumber","vendor-chunks/lodash.isboolean","vendor-chunks/safe-buffer","vendor-chunks/buffer-equal-constant-time"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fteacher%2Fanalytics%2Froute&page=%2Fapi%2Fteacher%2Fanalytics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fteacher%2Fanalytics%2Froute.ts&appDir=C%3A%5CUsers%5Cpc%5CDownloads%5Cproject%5Cproject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cpc%5CDownloads%5Cproject%5Cproject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();